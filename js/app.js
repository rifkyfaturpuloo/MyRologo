const catalogSource = {
  Jurusan: [
    {
      id: 'animasi',
      name: 'Animasi',
      group: 'Animasi',
      description: 'Animasi 2D/3D, storytelling, desain karakter, dan pipeline produksi profesional.',
      png: 'assets/logos/jurusan/ANIMASI.png',
      svg: 'assets/logos/jurusan/ANIMASI.svg',
    },
    {
      id: 'animasi-yellow',
      name: 'Animasi (Yellow Edition)',
      group: 'Animasi',
      description: 'Varian Animasi bernuansa kuning cerah dengan tipografi kontras hitam putih.',
      png: 'assets/logos/jurusan/ANIMASI-YELLOW.jpg',
      svg: 'assets/logos/jurusan/ANIMASI-YELLOW.svg',
    },
    {
      id: 'batik',
      name: 'Kriya Kreatif Batik dan Tekstil',
      group: 'Kriya Kreatif Batik dan Tekstil',
      description: 'Desain motif, teknik membatik, pewarnaan, dan produksi kain kreatif.',
      png: 'assets/logos/jurusan/BATIK.png',
      svg: 'assets/logos/jurusan/BATIK.svg',
    },
    {
      id: 'ditf',
      name: 'Desain Interior dan Teknik Furnitur',
      group: 'Desain Interior dan Teknik Furnitur',
      description: 'Perancangan ruang dan furnitur dengan prinsip ergonomi, material, dan konstruksi.',
      png: 'assets/logos/jurusan/DITF.jpg',
      svg: 'assets/logos/jurusan/DITF.svg',
    },
    {
      id: 'dkv',
      name: 'Logo Utama DKV',
      group: 'Desain Komunikasi Visual',
      description: 'Belajar desain visual, branding, ilustrasi, tipografi, layout, dan dasar UI.',
      png: 'assets/logos/jurusan/DKV.png',
      svg: 'assets/logos/jurusan/DKV.svg',
    },
    {
      id: 'dkv-east-java',
      name: 'DKV East Java Series',
      group: 'Desain Komunikasi Visual',
      description: 'Varian DKV bertema East Java dengan aksen kuning-biru energik.',
      png: 'assets/logos/jurusan/DKV-EAST-JAVA.jpg',
      svg: 'assets/logos/jurusan/DKV-EAST-JAVA.svg',
    },
    {
      id: 'dkv-japan',
      name: 'DKV Japan Series',
      group: 'Desain Komunikasi Visual',
      description: 'Visual DKV bergaya Jepang dengan guratan brush dan warna merah-putih.',
      png: 'assets/logos/jurusan/DKV-JAPAN.jpg',
      svg: 'assets/logos/jurusan/DKV-JAPAN.svg',
    },
    {
      id: 'dkv-jungle',
      name: 'DKV Jungle Series',
      group: 'Desain Komunikasi Visual',
      description: 'Eksplorasi hijau tropis untuk menonjolkan karakter adventurous jurusan DKV.',
      png: 'assets/logos/jurusan/DKV-JUNGLE.jpg',
      svg: 'assets/logos/jurusan/DKV-JUNGLE.svg',
    },
    {
      id: 'dkv-majapahitz',
      name: 'DKV Majapahitz',
      group: 'Desain Komunikasi Visual',
      description: 'Logo dengan elemen kerajaan Majapahit, kombinasi merah emas yang megah.',
      png: 'assets/logos/jurusan/DKV-MAJAPAHITZ.jpg',
      svg: 'assets/logos/jurusan/DKV-MAJAPAHITZ.svg',
    },
    {
      id: 'dkv-mandalika',
      name: 'DKV Mandalika',
      group: 'Desain Komunikasi Visual',
      description: 'Varian Mandalika mengangkat nuansa motorsport dan garis dinamis.',
      png: 'assets/logos/jurusan/DKV-MANDALIKA.jpg',
      svg: 'assets/logos/jurusan/DKV-MANDALIKA.svg',
    },
    {
      id: 'dkv-transparent',
      name: 'DKV Transparent',
      group: 'Desain Komunikasi Visual',
      description: 'Logo DKV tanpa latar sehingga siap ditempatkan di berbagai media.',
      png: 'assets/logos/jurusan/DKV-NO-BG.png',
      svg: 'assets/logos/jurusan/DKV-NO-BG.svg',
    },
    {
      id: 'dkv-with-text',
      name: 'DKV dengan Tagline',
      group: 'Desain Komunikasi Visual',
      description: 'Versi lengkap dengan teks “Desain Komunikasi Visual”.',
      png: 'assets/logos/jurusan/DKV-WITH-TEXT.png',
      svg: 'assets/logos/jurusan/DKV-WITH-TEXT.svg',
    },
    {
      id: 'dkv-tagline-isok-thok',
      name: 'DKV Tagline Isok Thok',
      group: 'Desain Komunikasi Visual',
      description: 'Poster tagline “Isok Thok” khas kultur kreatif DKV.',
      png: 'assets/logos/jurusan/DKV-TAGLINE-ISOK-THOK.jpeg',
      svg: 'assets/logos/jurusan/DKV-TAGLINE-ISOK-THOK.svg',
    },
    {
      id: 'film',
      name: 'Produksi Film',
      group: 'Produksi Film',
      description: 'Sinematografi, penyutradaraan, penulisan skenario, dan editing.',
      png: 'assets/logos/jurusan/FILM.png',
      svg: 'assets/logos/jurusan/FILM.svg',
    },
    {
      id: 'sinema-rolas',
      name: 'Sinema Rolas',
      group: 'Produksi Film',
      description: 'Identitas komunitas film SMKN 12 dengan reel oranye modern.',
      png: 'assets/logos/jurusan/SINEMA-ROLAS.png',
      svg: 'assets/logos/jurusan/SINEMA-ROLAS.svg',
    },
    {
      id: 'karawitan',
      name: 'Seni Karawitan',
      group: 'Seni Karawitan',
      description: 'Pembelajaran gamelan, garap, iringan, dan estetika musik tradisi.',
      png: 'assets/logos/jurusan/KARAWITAN.png',
      svg: 'assets/logos/jurusan/KARAWITAN.svg',
    },
    {
      id: 'kayu',
      name: 'Kriya Kreatif Kayu dan Rotan',
      group: 'Kriya Kreatif Kayu dan Rotan',
      description: 'Konstruksi, teknik sambungan, finishing, dan pembuatan produk kriya.',
      png: 'assets/logos/jurusan/KAYU.png',
      svg: 'assets/logos/jurusan/KAYU.svg',
    },
    {
      id: 'kulit',
      name: 'Kriya Kreatif Kulit dan Imitasi',
      group: 'Kriya Kreatif Kulit dan Imitasi',
      description: 'Perancangan produk kulit, teknik jahit, pola, dan finishing aksesori.',
      png: 'assets/logos/jurusan/KULIT.png',
      svg: 'assets/logos/jurusan/KULIT.svg',
    },
    {
      id: 'logam',
      name: 'Kriya Kreatif Logam dan Perhiasan',
      group: 'Kriya Kreatif Logam dan Perhiasan',
      description: 'Desain, pencetakan, dan finishing logam serta pembuatan perhiasan.',
      png: 'assets/logos/jurusan/LOGAM.png',
      svg: 'assets/logos/jurusan/LOGAM.svg',
    },
    {
      id: 'lukis',
      name: 'Seni Lukis',
      group: 'Seni Lukis',
      description: 'Mendalami teknik melukis tradisional hingga modern dan eksplorasi berbagai media.',
      png: 'assets/logos/jurusan/LUKIS.png',
      svg: 'assets/logos/jurusan/LUKIS.svg',
    },
    {
      id: 'musik',
      name: 'Seni Musik',
      group: 'Seni Musik',
      description: 'Ekosistem pembelajaran musik klasik hingga modern.',
      png: 'assets/logos/jurusan/MUSIK.png',
      svg: 'assets/logos/jurusan/MUSIK.svg',
    },
    {
      id: 'pedalangan',
      name: 'Seni Pedalangan',
      group: 'Seni Pedalangan',
      description: 'Pakeliran wayang, penguasaan narasi, musik, dan tata pertunjukan.',
      png: 'assets/logos/jurusan/PEDALANGAN.png',
      svg: 'assets/logos/jurusan/PEDALANGAN.svg',
    },
    {
      id: 'pplg',
      name: 'Logo Utama PPLG',
      group: 'Pengembangan Perangkat Lunak dan Gim',
      description: 'Fokus pada pemrograman, basis data, pengembangan web, dan pembuatan gim.',
      png: 'assets/logos/jurusan/PPLG.jpg',
      svg: 'assets/logos/jurusan/PPLG.svg',
    },
    {
      id: 'pplg-glyph',
      name: 'PPLG Tanpa Lingkaran',
      group: 'Pengembangan Perangkat Lunak dan Gim',
      description: 'Fokus pada pemrograman, basis data, pengembangan web, dan pembuatan gim.',
      png: 'assets/logos/jurusan/PPLG-2.png',
      svg: 'assets/logos/jurusan/PPLG-2.svg',
    },
    {
      id: 'tari',
      name: 'Seni Tari',
      group: 'Seni Tari',
      description: 'Teknik tari tradisional-modern, koreografi, dan penampilan panggung.',
      png: 'assets/logos/jurusan/TARI.jpg',
      svg: 'assets/logos/jurusan/TARI.svg',
    },
    {
      id: 'teater',
      name: 'Seni Teater',
      group: 'Seni Teater',
      description: 'Akting, penyutradaraan, penulisan naskah, dan produksi panggung.',
      png: 'assets/logos/jurusan/TEATER.png',
      svg: 'assets/logos/jurusan/TEATER.svg',
    },
    {
      id: 'teater-v2',
      name: 'Seni Teater (V2)',
      group: 'Seni Teater',
      description: 'Varian teater dengan warna baru untuk kampanye 2025.',
      png: 'assets/logos/jurusan/TEATER-V2.jpg',
      svg: 'assets/logos/jurusan/TEATER-V2.svg',
    },
  ],
  Ekstrakurikuler: [
    {
      id: 'basket',
      name: 'Basket',
      group: 'Olahraga',
      description: 'Program basket intensif dengan fokus fundamental, scrimmage, dan turnamen antar pelajar.',
      png: 'assets/logos/ekskul/BASKET.jpg',
      svg: 'assets/logos/ekskul/BASKET.svg',
    },
    {
      id: 'futsal',
      name: 'Futsal',
      group: 'Olahraga',
      description: 'Ekskul futsal dengan jadwal latihan rutin, analisis taktik, dan agenda kompetisi tahunan.',
      png: 'assets/logos/ekskul/FUTSAL.jpg',
      svg: 'assets/logos/ekskul/FUTSAL.svg',
    },
    {
      id: 'voli',
      name: 'Voli',
      group: 'Olahraga',
      description: 'Ekskul voli membina teknik servis, passing, dan strategi rotasi untuk tim putra-putri.',
      png: 'assets/logos/ekskul/VOLI.jpg',
      svg: 'assets/logos/ekskul/VOLI.svg',
    },
    {
      id: 'osis',
      name: 'OSIS',
      group: 'Kepemimpinan & Organisasi',
      description: 'OSIS menjadi pusat koordinasi event sekolah, dari seminar, classmeet, hingga kegiatan sosial.',
      png: 'assets/logos/ekskul/OSISROLAS.jpg',
      svg: 'assets/logos/ekskul/OSISROLAS.svg',
    },
    {
      id: 'panser',
      name: 'PANSER',
      group: 'Kepemimpinan & Organisasi',
      description: 'PANSER melatih baris-berbaris, ketepatan formasi, dan mental pengibar bendera tingkat kota.',
      png: 'assets/logos/ekskul/PANSER.jpg',
      svg: 'assets/logos/ekskul/PANSER.svg',
    },
    {
      id: 'parlas',
      name: 'PARLAS',
      group: 'Kepemimpinan & Organisasi',
      description: 'PARLAS adalah PMR Wira Rolas yang fokus pada pertolongan pertama dan edukasi kesehatan.',
      png: 'assets/logos/ekskul/PARLAS.jpg',
      svg: 'assets/logos/ekskul/PARLAS.svg',
    },
    {
      id: 'prakal',
      name: 'Prakalas',
      group: 'Kepemimpinan & Organisasi',
      description: 'Pramuka Kalas mengembangkan kepemimpinan, penjelajahan alam, dan pengabdian sosial.',
      png: 'assets/logos/ekskul/PRAKALAS.jpg',
      svg: 'assets/logos/ekskul/PRAKALAS.svg',
    },
    {
      id: 'pn',
      name: 'Pagar Nusa',
      group: 'Bela Diri',
      description: 'Pagar Nusa menaungi atlet pencak silat dengan latihan fisik, jurus, dan spiritual.',
      png: 'assets/logos/ekskul/PN.jpg',
      svg: 'assets/logos/ekskul/PN.svg',
    },
    {
      id: 'psht',
      name: 'PSHT',
      group: 'Bela Diri',
      description: 'PSHT menjaga tradisi bela diri Setia Hati Terate melalui latihan jurus dan filosofi persaudaraan.',
      png: 'assets/logos/ekskul/PSHT.jpg',
      svg: 'assets/logos/ekskul/PSHT.svg',
    },
    {
      id: 'ec',
      name: 'English Club',
      group: 'Kreatif & Literasi',
      description: 'English Club memoles kemampuan speaking, debate, hingga penulisan kreatif berbahasa Inggris.',
      png: 'assets/logos/ekskul/EC.jpg',
      svg: 'assets/logos/ekskul/EC.svg',
    },
    {
      id: 'rolascos',
      name: 'Rolascos',
      group: 'Kreatif & Literasi',
      description: 'Rolascos menyalurkan passion cosplay, perancangan kostum, dan perform panggung kreatif.',
      png: 'assets/logos/ekskul/ROLASCOS.jpg',
      svg: 'assets/logos/ekskul/ROLASCOS.svg',
    },
    {
      id: 'winzhy',
      name: 'Winzhy',
      group: 'Kreatif & Literasi',
      description: 'Winzhy merupakan komunitas modern dance yang fokus koreografi dan musikalitas.',
      png: 'assets/logos/ekskul/WINZHY.jpg',
      svg: 'assets/logos/ekskul/WINZHY.svg',
    },
    {
      id: 'rohis',
      name: 'Rohis',
      group: 'Kerohanian',
      description: 'Rohis menjadi wadah kajian, mentoring keislaman, serta manajemen kegiatan keagamaan sekolah.',
      png: 'assets/logos/ekskul/ROHIS.jpg',
      svg: 'assets/logos/ekskul/ROHIS.svg',
    },
    {
      id: 'twelvoster',
      name: 'Twelvoster',
      group: 'Supporter & Komunitas',
      description: 'Twelvoster adalah barisan supporter resmi dengan chant, koreografi tribun, dan budaya sportivitas.',
      png: 'assets/logos/ekskul/TWELVOSTER.jpg',
      svg: 'assets/logos/ekskul/TWELVOSTER.svg',
    },
  ],
  Event: [
    {
      id: 'indist-2025',
      name: 'INDIST 2025',
      group: 'INDIST',
      description: 'Logo utama INDIST 2025 dengan komposisi futuristik dan neon.',
      png: 'assets/logo-indist/indist-2025.jpg',
      svg: 'assets/logo-indist/indist-2025.svg',
    },
    {
      id: 'indist-2024',
      name: 'INDIST 2024',
      group: 'INDIST',
      description: 'Identitas 2024 bernuansa magenta dan ilustrasi percikan cat.',
      png: 'assets/logo-indist/indist-2024.jpeg',
      svg: 'assets/logo-indist/indist-2024.svg',
    },
    {
      id: 'indist-2021',
      name: 'INDIST 2021/2022',
      group: 'INDIST',
      description: 'Logo INDIST periode 2021-2022 untuk kebutuhan arsip branding.',
      png: 'assets/logo-indist/indist-2021-2022.png',
      svg: 'assets/logo-indist/indist-2021-2022.svg',
    },
  ],
};

const catalogs = Object.fromEntries(
  Object.entries(catalogSource).map(([category, items]) => [
    category,
    items.map((item) => ({ ...item, category })),
  ])
);

const logos = Object.values(catalogs).flat();

const categoryConfigs = {
  Jurusan: {
    grid: document.getElementById('jurusanGrid'),
    section: document.getElementById('logo-jurusan'),
    grouped: true,
  },
  Ekstrakurikuler: {
    grid: document.getElementById('ekskulGrid'),
    section: document.getElementById('logo-ekskul'),
    grouped: true,
  },
  Event: {
    grid: document.getElementById('eventGrid'),
    section: document.getElementById('logo-event'),
    grouped: true,
  },
};

const state = {
  query: '',
  filter: 'Semua',
};

const elements = {
  search: document.getElementById('searchInput'),
  filters: document.querySelectorAll('.filter-btn'),
  quickFilterButtons: document.querySelectorAll('[data-filter].pill, [data-filter].chip-button'),
  quickScrollButtons: document.querySelectorAll('[data-scroll]'),
  reset: document.getElementById('resetFilters'),
  themeToggle: document.getElementById('themeToggle'),
  emptyState: document.getElementById('emptyState'),
  year: document.getElementById('year'),
  schoolGrid: document.getElementById('schoolGrid'),
  menuToggle: document.getElementById('menuToggle'),
  header: document.querySelector('.site-header'),
  navLinks: document.querySelectorAll('.site-nav a'),
};

const categoryOrder = Object.keys(categoryConfigs);

const schoolLogos = [
  {
    id: 'logo-prov-jatim',
    name: 'Logo Provinsi Jawa Timur',
    description: 'Lambang provinsi untuk kebutuhan protokoler resmi.',
    preview: 'assets/logo-sekolah/prov-jatim.png',
    downloads: [
      { label: 'Download PNG', href: 'assets/logo-sekolah/prov-jatim.png', filename: 'prov-jatim.png' },
      { label: 'Download SVG', href: 'assets/logo-sekolah/prov-jatim.svg', filename: 'prov-jatim.svg' },
    ],
  },
  {
    id: 'logo-smk-bisa',
    name: 'Logo SMK Bisa SMK Hebat',
    description: 'Identitas nasional vokasi SMK dengan warna biru orange.',
    preview: 'assets/logo-sekolah/smk-bisa-smk-hebat.png',
    downloads: [
      {
        label: 'Download PNG',
        href: 'assets/logo-sekolah/smk-bisa-smk-hebat.png',
        filename: 'smk-bisa-smk-hebat.png',
      },
      {
        label: 'Download SVG',
        href: 'assets/logo-sekolah/smk-bisa-smk-hebat.svg',
        filename: 'smk-bisa-smk-hebat.svg',
      },
    ],
  },
  {
    id: 'tagline-bg',
    name: 'Tagline The Real Arts School (BG)',
    description: 'Poster tagline lengkap dengan latar tekstur artistik.',
    preview: 'assets/logo-sekolah/tagline-real-arts-bg.jpg',
    downloads: [
      {
        label: 'Download JPG',
        href: 'assets/logo-sekolah/tagline-real-arts-bg.jpg',
        filename: 'tagline-real-arts-bg.jpg',
      },
      {
        label: 'Download SVG',
        href: 'assets/logo-sekolah/tagline-real-arts-bg.svg',
        filename: 'tagline-real-arts-bg.svg',
      },
    ],
  },
  {
    id: 'tagline-no-bg',
    name: 'Tagline The Real Arts School (Transparan)',
    description: 'Versi tanpa latar cocok untuk overlay di materi digital.',
    preview: 'assets/logo-sekolah/tagline-real-arts.png',
    downloads: [
      {
        label: 'Download PNG',
        href: 'assets/logo-sekolah/tagline-real-arts.png',
        filename: 'tagline-real-arts.png',
      },
      {
        label: 'Download SVG',
        href: 'assets/logo-sekolah/tagline-real-arts.svg',
        filename: 'tagline-real-arts.svg',
      },
    ],
  },
];

const normalize = (value) => value.toLowerCase().trim();

const getBadgeClass = (category) => {
  if (category === 'Jurusan') return 'badge badge-jurusan';
  if (category === 'Ekstrakurikuler') return 'badge badge-ekskul';
  return 'badge badge-indist';
};

function matchesState(logo) {
  const query = normalize(state.query);
  const matchesFilter = state.filter === 'Semua' || logo.category === state.filter;
  if (!matchesFilter) return false;

  if (!query) return true;

  return (
    normalize(logo.name).includes(query) ||
    normalize(logo.description).includes(query) ||
    normalize(logo.group || '').includes(query) ||
    normalize(logo.id).includes(query)
  );
}

function createCard(logo) {
  const wrapper = document.createElement('article');
  wrapper.className = 'logo-card';
  wrapper.innerHTML = `
    <span class="${getBadgeClass(logo.category)}">${logo.category}</span>
    <div class="logo-card__img">
      <img src="${logo.png}" alt="Logo ${logo.name}" loading="lazy" />
    </div>
    <div>
      <h3>${logo.name}</h3>
      <p>${logo.description}</p>
    </div>
    <div class="logo-card__actions">
      <a class="btn" href="${logo.png}" download="${logo.id}.png">Download PNG</a>
      <a class="btn" href="${logo.svg}" download="${logo.id}.svg">Download SVG</a>
    </div>
  `;
  return wrapper;
}

function groupByCluster(items) {
  const groups = new Map();
  items.forEach((item) => {
    const key = item.group || item.name;
    if (!groups.has(key)) groups.set(key, []);
    groups.get(key).push(item);
  });
  return groups;
}

function renderGroupedGrid(container, items) {
  container.innerHTML = '';
  container.classList.add('accordion-stack');
  const groups = groupByCluster(items);
  let index = 0;
  groups.forEach((groupItems, title) => {
    const details = document.createElement('details');
    details.className = 'logo-accordion';
    if (index === 0) details.open = true;

    const summary = document.createElement('summary');
    summary.innerHTML = `
      <span>${title}</span>
      <small>${groupItems.length} logo</small>
    `;
    details.appendChild(summary);

    const content = document.createElement('div');
    content.className = 'logo-accordion__content';
    const grid = document.createElement('div');
    grid.className = 'logo-grid';
    groupItems.forEach((item) => grid.appendChild(createCard(item)));
    content.appendChild(grid);
    details.appendChild(content);
    container.appendChild(details);
    index += 1;
  });
}

function renderSimpleGrid(container, items) {
  container.innerHTML = '';
  container.classList.remove('accordion-stack');
  items.forEach((item) => container.appendChild(createCard(item)));
}

function renderGrids() {
  let total = 0;
  categoryOrder.forEach((category) => {
    const config = categoryConfigs[category];
    if (!config?.grid || !config?.section) return;

    const filtered = catalogs[category].filter((logo) => matchesState(logo));
    const hiddenByFilter = state.filter !== 'Semua' && state.filter !== category;

    if (hiddenByFilter || filtered.length === 0) {
      config.section.classList.add('is-hidden');
      config.grid.innerHTML = '';
      return;
    }

    config.section.classList.remove('is-hidden');
    if (config.grouped) {
      renderGroupedGrid(config.grid, filtered);
    } else {
      renderSimpleGrid(config.grid, filtered);
    }
    total += filtered.length;
  });

  elements.emptyState.hidden = total > 0;
}

function setFilter(value) {
  state.filter = value;
  elements.filters.forEach((btn) => {
    const active = btn.dataset.filter === value;
    btn.classList.toggle('is-active', active);
    btn.setAttribute('aria-selected', String(active));
  });
  renderGrids();
}

function setQuery(value) {
  state.query = value;
  renderGrids();
}

function scrollToTarget(target) {
  const el = document.querySelector(target);
  if (el) {
    el.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
}

function setMenuState(isOpen) {
  if (!elements.header || !elements.menuToggle) return;
  elements.header.classList.toggle('menu-open', isOpen);
  elements.menuToggle.setAttribute('aria-expanded', String(isOpen));
}

function toggleMenuState() {
  if (!elements.header) return;
  const willOpen = !elements.header.classList.contains('menu-open');
  setMenuState(willOpen);
}

function initTheme() {
  const stored = localStorage.getItem('myro-theme');
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const theme = stored || (prefersDark ? 'dark' : 'light');
  document.documentElement.setAttribute('data-theme', theme);
  updateThemeToggle(theme);
}

function updateThemeToggle(theme) {
  const icon = theme === 'dark' ? '\u263E' : '\u2600';
  const label = theme === 'dark' ? 'Mode Terang' : 'Mode Gelap';
  elements.themeToggle.querySelector('.theme-toggle__icon').textContent = icon;
  elements.themeToggle.querySelector('.theme-toggle__text').textContent = label;
}

function toggleTheme() {
  const current = document.documentElement.getAttribute('data-theme') || 'light';
  const next = current === 'dark' ? 'light' : 'dark';
  document.documentElement.setAttribute('data-theme', next);
  localStorage.setItem('myro-theme', next);
  updateThemeToggle(next);
}

function renderSchoolLogos() {
  if (!elements.schoolGrid) return;
  elements.schoolGrid.innerHTML = '';
  schoolLogos.forEach((asset) => {
    const card = document.createElement('article');
    card.className = 'school-tile';
    card.innerHTML = `
      <div class="school-tile__preview">
        <img src="${asset.preview}" alt="${asset.name}" loading="lazy" />
      </div>
      <div class="school-tile__body">
        <h4>${asset.name}</h4>
        <p>${asset.description}</p>
      </div>
    `;
    const actions = document.createElement('div');
    actions.className = 'school-tile__actions';
    asset.downloads.forEach((download) => {
      const link = document.createElement('a');
      link.className = 'btn btn-outline';
      link.textContent = download.label;
      link.href = download.href;
      link.download = download.filename;
      actions.appendChild(link);
    });
    card.appendChild(actions);
    elements.schoolGrid.appendChild(card);
  });
}

function initEvents() {
  elements.search.addEventListener('input', (event) => setQuery(event.target.value));

  elements.filters.forEach((button) =>
    button.addEventListener('click', () => setFilter(button.dataset.filter))
  );

  elements.quickFilterButtons.forEach((button) =>
    button.addEventListener('click', () => setFilter(button.dataset.filter))
  );

  elements.quickScrollButtons.forEach((button) =>
    button.addEventListener('click', () => scrollToTarget(button.dataset.scroll))
  );

  elements.reset.addEventListener('click', () => {
    elements.search.value = '';
    setQuery('');
    setFilter('Semua');
  });

  elements.themeToggle.addEventListener('click', toggleTheme);

  if (elements.menuToggle) {
    elements.menuToggle.addEventListener('click', toggleMenuState);
  }

  elements.navLinks.forEach((link) =>
    link.addEventListener('click', () => {
      if (window.matchMedia('(max-width: 768px)').matches) {
        setMenuState(false);
      }
    })
  );
}

function initFooter() {
  if (elements.year) {
    elements.year.textContent = new Date().getFullYear();
  }
}

function initApp() {
  initTheme();
  initEvents();
  initFooter();
  renderSchoolLogos();
  setMenuState(false);
  renderGrids();
}

document.addEventListener('DOMContentLoaded', initApp);


